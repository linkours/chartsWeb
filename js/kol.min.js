$(function(){
	var tooltipData={trigger: 'axis'};
    var gridData={
    		left: '0',
	        right: '0',
	        top: '8%',
	        bottom: '1%',
	        containLabel: true
   	};
   	var yAxisData={
   			type: 'value',
	        axisTick:{
		        show:false//隐藏Y轴刻度
		    },
		    axisLine: {
				show: false
			}
	};
	var itemStyleData={
		normal: {
            color: "#2799DF",
            lineStyle: {
                color: "#2799DF"
            }
        }
	}
    var onesPub = echarts.init(document.getElementById('onesPub'));
	var	option = {
	    tooltip: tooltipData,
	    xAxis: {
	        type: 'category',
	        data: []
	    },
	    grid: gridData,
	    yAxis: yAxisData,
	    series: [{
	            name: '总阅读数',
	            type: 'line',
	            itemStyle: itemStyleData,
	            data: []
	        }]
	};
	onesPub.setOption(option);
    var timeArr=[];
    var valueArr=[];
    var topArr=[];
    var aveArr=[];
    var likeArr=[];
    var zrankArr=[];
    var flrankArr=[];
    var wciArr=[];
    var weekarcArr=[];
    $.ajax({
    	type:"get",
		url:"../kol/details.json",
		success:function(data){
			data=eval(data);
			var allLen=data.dataInfo.length;
			var allTxt=data.dataInfo;
			for(var i=0;i<allLen;i++){
				var allTime=allTxt[i].times;
				var allvalue=allTxt[i].all;
				var zrankval=allTxt[i].zrank;
				var weekarcval=allTxt[i].week;
				timeArr.push(allTime);
				valueArr.push(allvalue);
				zrankArr.push(zrankval);
				weekarcArr.push(weekarcval);
			}
			onesPub.setOption({
				xAxis:[{data:timeArr}],
				series:[{data:valueArr}]
			});
			twoPub.setOption({
				xAxis:[{data:timeArr}],
				series:[{data:zrankArr}]
			});
			weekTotal.setOption({
				xAxis:[{data:timeArr}],
				series:[{data:weekarcArr}]
			});
		}
    });
    $(".oneUl li").each(function(){
    	$(this).click(function(){
    		onesPub.showLoading();
    		$(".oneUl li").removeClass("active");
    		$(this).addClass("active");
    		var thisTxt=$(".oneUl .active").attr("data-title");
    		$.ajax({
    			type:"get",
    			url:"../kol/details.json",
    			success:function(data){
    				data=eval(data);
					var allLen=data.dataInfo.length;
					var allTxt=data.dataInfo;
    				for(var i=0;i<allLen;i++){
    					var topvalue=allTxt[i].top;
    					var avevalue=allTxt[i].ave;
    					var likevalue=allTxt[i].like;
    					topArr.push(topvalue);
    					aveArr.push(avevalue);
    					likeArr.push(likevalue);
    				}
    				if(thisTxt=="allRead"){
    					onesPub.hideLoading();
    					onesPub.setOption({
							series:[{data:valueArr,name:"总阅读数"}]
						});
    				}else if(thisTxt=="topRead"){
    					onesPub.hideLoading();
    					onesPub.setOption({
							series:[{data:topArr,name:"头条阅读数"}]
						});
    				}else if(thisTxt=="aveRead"){
    					onesPub.hideLoading();
    					onesPub.setOption({
							series:[{data:aveArr,name:"平均阅读数"}]
						});
    				}else if(thisTxt=="likeNum"){
    					onesPub.hideLoading();
    					onesPub.setOption({
							series:[{data:likeArr,name:"点赞数"}]
						});
    				}
    			}
    		});
    	});
    });
    //
    var twoPub = echarts.init(document.getElementById('twoPub'));
	var	option = {
	    tooltip: tooltipData,
	    xAxis: {
	        type: 'category',
	        data: []
	    },
	    grid: gridData,
	    yAxis:{
   			type: 'value',
	        min: 0,
	        interval: 2,
	        axisTick:{
		        show:false//隐藏Y轴刻度
		    },
		    axisLine: {
				show: false
			}
		},
	    series: [{
	            name: '排名',
	            type: 'line',
	            itemStyle: itemStyleData,
	            data: []
	        }]
	};
	twoPub.setOption(option);
	$(".twoUl li").each(function(){
		$(this).click(function(){
    		twoPub.showLoading();
    		$(".twoUl li").removeClass("active");
    		$(this).addClass("active");
    		var thisTxt=$(".twoUl .active").attr("data-title");
    		$.ajax({
    			type:"get",
    			url:"../kol/details.json",
    			success:function(data){
    				data=eval(data);
    				var allLen=data.dataInfo.length;
					var allTxt=data.dataInfo;
    				for(var i=0;i<allLen;i++){
    					var zrankval=allTxt[i].zrank;
    					var flrankval=allTxt[i].flrank;
    					var wcival=allTxt[i].wci;
    					zrankArr.push(zrankval);
    					flrankArr.push(flrankval);
    					wciArr.push(wcival);
    				}
    				if(thisTxt=="allRanking"){
    					twoPub.hideLoading();
    					twoPub.setOption({
    						yAxis:[{min: 0,interval:2}],
							series:[{data:zrankArr,name:"总排名"}]
						});
    				}else if(thisTxt=="flRanking"){
    					twoPub.hideLoading();
    					twoPub.setOption({
    						yAxis:[{min: 0,interval:2}],
							series:[{data:flrankArr,name:"分类排名"}]
						});
    				}else if(thisTxt=="wci"){
    					twoPub.hideLoading();
    					twoPub.setOption({
    						yAxis:[{min: null,interval:""}],
							series:[{data:wciArr,name:"WCI"}]
						});
    				}
    			}
    		});
		});
	});
    //
    var weekTotal = echarts.init(document.getElementById('weekTotal'));
	var	option = {
		title: {
	        text: '7天内每天发文数量',
	        x: 'center',
	        top:'0',
	        textStyle: {
				fontSize: 15,
				fontWeight:100
			},
	    },
	    tooltip: tooltipData,
	    xAxis: {
	        type: 'category',
	        data: []
	    },
	    grid: {
    		left: '0',
	        right: '0',
	        top: '14%',
	        bottom: '1%',
	        containLabel: true
   		},
	    yAxis: yAxisData,
	    series: [{
	            name: '发文数量',
	            type: 'line',
	            itemStyle: itemStyleData,
	            data: []
	        }]
	};
	weekTotal.setOption(option);
	//
	var aveTimes = echarts.init(document.getElementById('aveTimes'));
	var option = {
		title: {
	        text: '平均24小时文章发布时段',
	        x: 'center',
	        top:'0',
	        textStyle: {
				fontSize: 15,
				fontWeight:100
			},
	    },
	    tooltip: {
			trigger: 'item',
	        formatter: "{b} 点<br/> {c}篇文章"	    	
	    },
	    grid: {
    		left: '0',
	        right: '0',
	        top: '14%',
	        bottom: '1%',
	        containLabel: true
   		},
	    xAxis: [{
	            type: 'category',
	            data: [1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24],
	            axisLabel: {
		            interval: 0,
		        }
	       }],
	    yAxis: yAxisData,
	    series: [{
	            name:'发文时段',
	            type:'bar',
	            barWidth:'10',
	            itemStyle: itemStyleData,
	            data:[0, 0, 0, 0, 0, 0, 0, 0, 0, 5, 0, 0,5, 4, 7, 2, 6, 7, 6, 2, 0, 0, 0, 0]
	       }]
	};
	aveTimes.setOption(option);
});
